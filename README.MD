# CP Demo Server - Threat Prevention Showcase

![Flask](https://img.shields.io/badge/Flask-3.1.0-blue.svg)
![SQLite](https://img.shields.io/badge/SQLite-3.36.0-brightgreen.svg)
![Python](https://img.shields.io/badge/Python-3.8%2B-blue.svg)
![License](https://img.shields.io/badge/License-MIT-yellow.svg)

---

## ðŸ“‹ Table of Contents

- [Overview](#overview)
- [Features](#features)
- [Technologies Used](#technologies-used)
- [Project Structure](#project-structure)
- [Installation](#installation)
  - [Prerequisites](#prerequisites)
  - [Setup Instructions](#setup-instructions)
- [Usage](#usage)
  - [IPS Protections](#ips-protections)
  - [File Generation](#file-generation)
  - [Attack Simulation](#attack-simulation)
- [Docker Deployment](#docker-deployment)
  - [Dockerfile Content](#dockerfile-content)
  - [Build and Run](#build-and-run)


- [Requirements](#requirements)
  - [Python Libraries](#python-libraries)
  - [System-Level Dependencies](#system-level-dependencies)
  - [Docker-Specific Requirements](#docker-specific-requirements)
- [Configuration](#configuration)
  - [Environment Variables](#environment-variables)
  - [Logging](#logging)
- [Logging](#logging-1)
  - [Key Features](#key-features)
  - [Viewing Logs](#viewing-logs)
- [Contributing](#contributing)
- [License](#license)
- [Contact](#contact)

---

## Overview

The **CP Demo Server** is a Flask-based web application designed to showcase advanced IPS (Intrusion Prevention System) protections, file generation, and attack simulation capabilities. This server allows users to interact with a feature-rich web interface for generating files, testing intrusion protection mechanisms, and simulating network attacks.

---

## Features

### IPS Protections

- **Dynamic Target Selection:** Customize the target IP for IPS testing scenarios.
- **Comprehensive Protections:** Simulate and validate industry-standard IPS measures.
- **Configurable Parameters:** Set confidence levels, severity, and performance impact metrics.

### File Generation

- **Diverse File Formats:** Generate files in formats like PDF, DOCX, PPTX, JPG, and more.
- **Feature Inclusion:** Embed scripts, URLs, multimedia, or malicious payloads.
- **Payload Simulation:** Include benign or simulated malicious payloads for testing.

### Attack Simulation

- **Protocol-Specific Attacks:** Launch ICMP Flood, SYN Flood, DNS Attacks, and more.
- **Custom Payloads:** Create and execute user-defined attack payloads.
- **Real-Time Status:** Track attack progress and monitor simulation details.

---

## Technologies Used

- **Backend:**
  - [Flask](https://flask.palletsprojects.com/) - A lightweight WSGI web application framework.
  - [SQLite](https://www.sqlite.org/index.html) - A C library that provides a lightweight disk-based database.
  
- **Frontend:**
  - [Bootstrap](https://getbootstrap.com/) - A CSS framework for building responsive and mobile-first websites.
  - [Bootstrap Icons](https://icons.getbootstrap.com/) - A growing library of open source icons.
  
- **Programming Languages:**
  - [Python](https://www.python.org/) - A high-level, interpreted programming language.
  
- **Others:**
  - [Gunicorn](https://gunicorn.org/) - A Python WSGI HTTP Server for UNIX.
  - [PyInstaller](https://www.pyinstaller.org/) - Converts Python applications into stand-alone executables.

---

## Project Structure

```bash
CP-Demo-Server/
â”‚
â”œâ”€â”€ attack_generator.py               # Script to generate attack simulations
â”œâ”€â”€ certificate/                      # Directory for SSL certificates
â”‚   â”œâ”€â”€ cert.pem                      # Public certificate
â”‚   â”œâ”€â”€ cp_demo_server.p12            # PKCS#12 archive containing cert and key
â”‚   â”œâ”€â”€ key.pem                       # Private key
â”‚   â””â”€â”€ openssl.cnf                   # OpenSSL configuration file
â”œâ”€â”€ data/                             # Data storage directory
â”‚   â”œâ”€â”€ cp_demo_server.log            # Server log file
â”‚   â”œâ”€â”€ db.log                        # Database log file
â”‚   â”œâ”€â”€ secret_key = super secret key  # Configuration for Flask secret key
â”‚   â”œâ”€â”€ generated_files.db            # Database for generated files
â”‚   â”œâ”€â”€ ioc_files/                    # Indicators of Compromise (IoC) files
â”‚   â”‚   â”œâ”€â”€ docx_ioc_demo.docx        # Sample DOCX IoC file
â”‚   â”‚   â”œâ”€â”€ endpoint_security_datasheet.pdf # Sample PDF IoC file
â”‚   â”‚   â””â”€â”€ ioc_demo.csv               # Sample CSV IoC file
â”‚   â”œâ”€â”€ ips_protections_demo.csv      # IPS protections data
â”‚   â”œâ”€â”€ protections.db                # Database for IPS protections
â”‚   â””â”€â”€ run_script.log                # Log for run scripts
â”œâ”€â”€ db.py                             # Database setup and management script
â”œâ”€â”€ file_generator.py                 # Script for generating files
â”œâ”€â”€ files/                            # Directory for various files
â”‚   â”œâ”€â”€ generated_files/              # Directory for generated/downloadable files
â”‚   â”œâ”€â”€ malicious_urls.txt            # List of malicious URLs
â”‚   â””â”€â”€ pdf_assets/                   # Assets used in PDF generation
â”‚       â”œâ”€â”€ sample_mp3_file.mp3        # Sample MP3 file
â”‚       â”œâ”€â”€ sample_mp4_file.mp4        # Sample MP4 file
â”‚       â”œâ”€â”€ sample_pdf_file.pdf        # Sample PDF file
â”‚       â””â”€â”€ sample_png_img.png         # Sample PNG image
â”œâ”€â”€ __init__.py                       # Python package initializer
â”œâ”€â”€ Install_script.sh                 # Shell script for installation
â”œâ”€â”€ __pycache__/                      # Compiled Python files
â”‚   â”œâ”€â”€ attack_generator.cpython-312.pyc
â”‚   â”œâ”€â”€ db.cpython-312.pyc
â”‚   â”œâ”€â”€ file_generator.cpython-312.pyc
â”‚   â”œâ”€â”€ __init__.cpython-312.pyc
â”‚   â”œâ”€â”€ run.cpython-312.pyc
â”‚   â””â”€â”€ views.cpython-312.pyc
â”œâ”€â”€ README.MD                         # Current README file
â”œâ”€â”€ README.MD.old                     # Previous version of README
â”œâ”€â”€ requirements.txt                  # Python dependencies
â”œâ”€â”€ run.py                            # Entry point for running the application
â”œâ”€â”€ scripts/                          # Directory for auxiliary scripts
â”‚   â”œâ”€â”€ css/                           # CSS assets
â”‚   â”‚   â”œâ”€â”€ bootstrap-toggle.css        # Bootstrap toggle styles
â”‚   â”‚   â”œâ”€â”€ dark-mode.css               # Dark mode styles
â”‚   â”‚   â”œâ”€â”€ datatables.css               # DataTables styles
â”‚   â”‚   â””â”€â”€ styles.css                   # Custom styles
â”‚   â”œâ”€â”€ js/                            # JavaScript assets
â”‚   â”‚   â”œâ”€â”€ bootstrap_toggle.js          # Bootstrap toggle scripts
â”‚   â”‚   â””â”€â”€ dark-mode-switch.js          # Dark mode switch scripts
â”‚   â””â”€â”€ random_files/                  # Directory for random file generation
â”‚       â”œâ”€â”€ random_file_generator.py     # Script to generate random files
â”‚       â””â”€â”€ words_list.txt               # List of words for file generation
â”œâ”€â”€ static/                           # Static assets for the web app
â”‚   â”œâ”€â”€ check-point-logo-large.webp    # Check Point logo (large)
â”‚   â”œâ”€â”€ check_point.png                 # Check Point logo
â”‚   â”œâ”€â”€ favicon.ico                     # Favicon for the website
â”‚   â”œâ”€â”€ favicons/                       # Additional favicon assets
â”‚   â”‚   â”œâ”€â”€ android-chrome-192x192.png
â”‚   â”‚   â”œâ”€â”€ android-chrome-512x512.png
â”‚   â”‚   â”œâ”€â”€ apple-touch-icon.png
â”‚   â”‚   â”œâ”€â”€ favicon-16x16.png
â”‚   â”‚   â”œâ”€â”€ favicon-32x32.png
â”‚   â”‚   â””â”€â”€ site.webmanifest             # Web manifest for PWA support
â”‚   â”œâ”€â”€ loadingimage.gif                # Loading animation image
â”‚   â””â”€â”€ quantum_logo.jpg                 # Quantum logo image
â”œâ”€â”€ templates/                        # HTML templates for the web app
â”‚   â”œâ”€â”€ attack_generators.html          # Attack generators page
â”‚   â”œâ”€â”€ av.html                         # Antivirus (AV) page
â”‚   â”œâ”€â”€ base.html                       # Base HTML template
â”‚   â”œâ”€â”€ footbar.html                    # Footer bar template
â”‚   â”œâ”€â”€ index.html                      # Home page
â”‚   â”œâ”€â”€ ips.html                        # Intrusion Prevention System (IPS) page
â”‚   â”œâ”€â”€ navbar.html                     # Navigation bar template
â”‚   â””â”€â”€ te.html                         # TE page (specific purpose)
â”œâ”€â”€ tree.txt                          # Text file containing the project directory tree
â””â”€â”€ views.py                          # View functions for the web app

```

**Explanation of Key Directories:**

- **`data/`:** Contains databases, log files, and CSV data used by `db.py`.
- **`data/ioc_files/`:** Contains the CSV and PDF Test FIles for the IoC demo.
- **`templates/`:** Holds HTML templates for rendering web pages.
- **`static/`:** Stores static assets like CSS, JavaScript, and site images.
- **`files/generated_files/`:** Directory where generated/downloadable files are stored.
- **`files/malware_samples/`:** Directory where the Malware Files files are stored.
- **`files/pdf_assets/`:** Contains files used by the PDF generator.
---

## Installation

### Prerequisites

Ensure the following are installed on your system:

1. **Python 3.8+**
2. **Pip**: Python package manager.
3. **Virtualenv**: To create isolated Python environments.
4. **System Dependencies** (see below).

### Setup Instructions


**Clone the Repository:**

```bash
git clone https://github.com/alshawwaf/cp_demo_server.git
```

Install System-Level Dependencies (Linux Example):

```bash
sudo apt update
sudo apt install -y python3-virtualenv libpcap-dev libffi-dev build-essential gcc ghostscript imagemagick libcurl4-openssl-dev mingw-w64
```
Set Up a Virtual Environment:

```bash
virtualenv venv
source venv/bin/activate
```

Install Python Dependencies:

```bash
pip install flask flask-wtf requests scapy
```

Grant Network Permissions for Scapy:

```bash
sudo setcap cap_net_raw,cap_net_admin=eip venv/bin/python3
```

Generate SSL Certificates:

```bash
touch certificate/openssl.cnf
cat >> certificate/openssl.cnf <<EOF
[ req ]
prompt = no
distinguished_name = americas-ses.com

[ americas-ses.com ]
countryName=            CA
stateOrProvinceName=    ON
localityName=           Ottawa
organizationName=       server.Americas-ses
organizationalUnitName= Demo TLS Web Server
commonName=             server-22.americas-ses.ca
emailAddress = kalshaww@checkpoint.com
EOF
```
Generate Self-Signed Certificates:

```bash
sudo apt install openssl -y
openssl req -x509 --config certificate/openssl.cnf -newkey rsa:4096 -nodes -out certificate/cert.pem -keyout certificate/key.pem -days 365

openssl pkcs12 -export -out certificate/cp_demo_server.p12 -inkey certificate/key.pem -in certificate/cert.pem -passout pass:vpn123!
```

Run the Application:

```bash
python run.py
```
### Access the Application:

Open your browser and navigate to http://127.0.0.1:8080.

Run as a Service (Optional):

To run the application as a service using systemd, follow these steps:

Create the Service File:

```bash
sudo nano /etc/systemd/system/cp_demo_server.service
```

Add the Following Content:

```ini
[Unit]
Description=CP Demo Server
After=network.target

[Service]
User=kali
WorkingDirectory=/home/kali/Desktop/cp_demo_server/
ExecStart=/home/kali/Desktop/cp_demo_server/venv/bin/python3 /home/kali/Desktop/cp_demo_server/run.py
Restart=always

[Install]
WantedBy=multi-user.target
```

Reload systemd and Enable the Service:

```bash
sudo systemctl daemon-reload
sudo systemctl enable cp_demo_server.service
sudo systemctl start cp_demo_server.service
```

## License
Licensed under the MIT License. See the LICENSE file for details.

## Contact
For any inquiries or support, please contact:

- Author: Khalid Alshawwaf
- Email: kalshaww@checkpoint.com
- GitHub: alshawwaf

âœ¨ Thank you for using CP Demo Server! âœ¨

---
